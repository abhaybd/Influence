(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{14:function(e,t,a){},15:function(e,t,a){},16:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(2),c=a.n(r),o=(a(14),a(3)),s=(a(15),a(4)),i=a(1),u=a(6),m=a(5);function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function h(e,t){if(null==e)return{};var a,n,l=function(e,t){if(null==e)return{};var a,n,l={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(l[a]=e[a]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var p=l.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),f=l.a.createElement("path",{d:"M11.67 3.87L9.9 2.1 0 12l9.9 9.9 1.77-1.77L3.54 12z"}),E=function(e){var t=e.svgRef,a=e.title,n=h(e,["svgRef","title"]);return l.a.createElement("svg",d({height:24,viewBox:"0 0 24 24",width:24,ref:t},n),a?l.a.createElement("title",null,a):null,p,f)},b=l.a.forwardRef((function(e,t){return l.a.createElement(E,d({svgRef:t},e))})),y=(a.p,function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={name:"",code:""},n.nameChange=n.nameChange.bind(Object(i.a)(n)),n.codeChange=n.codeChange.bind(Object(i.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(i.a)(n)),n}return Object(s.a)(a,[{key:"nameChange",value:function(e){this.setState({name:e.target.value.replace(/[^A-Za-z]/g,"")})}},{key:"codeChange",value:function(e){this.setState({code:e.target.value})}},{key:"handleSubmit",value:function(e){e.preventDefault();var t=this.state.name,a=this.state.code,n=this.props;a.length>0&&t.length>0&&j("exists",a,(function(e){e.content?(n.store.code=a,n.store.name=t,P()):alert("Invalid room code!")}))}},{key:"render",value:function(){return l.a.createElement("form",{onSubmit:this.handleSubmit},l.a.createElement("table",{className:"formtable"},l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("button",{id:"back"},l.a.createElement(b,{onClick:L})))),l.a.createElement("tr",null,l.a.createElement("td",null,"Name:"),l.a.createElement("td",null,l.a.createElement("input",{type:"text",value:this.state.name,size:"10",onChange:this.nameChange}))),l.a.createElement("tr",null,l.a.createElement("td",null,"Code:"),l.a.createElement("td",null,l.a.createElement("input",{type:"text",value:this.state.code,size:"10",onChange:this.codeChange}))),l.a.createElement("tr",null,l.a.createElement("td",{colSpan:"2"},l.a.createElement("input",{type:"submit",value:"Join Lobby"}))))))}}]),a}(l.a.Component)),v=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={name:""},n.handleChange=n.handleChange.bind(Object(i.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(i.a)(n)),n}return Object(s.a)(a,[{key:"handleChange",value:function(e){this.setState({name:e.target.value.replace(/[^A-Za-z]/g,"")})}},{key:"handleSubmit",value:function(e){if(e.preventDefault(),this.state.name.length>0){this.props.store.name=this.state.name;var t=new XMLHttpRequest;t.open("POST","/lobby"),t.setRequestHeader("Content-type","application/json"),t.send(JSON.stringify({type:"create"}));var a=this.props;t.onreadystatechange=function(){4===this.readyState&&200===this.status&&(console.log(t.responseText),a.store.code=JSON.parse(t.responseText).content,P())}}}},{key:"render",value:function(){return l.a.createElement("form",{onSubmit:this.handleSubmit},l.a.createElement("table",{className:"formtable"},l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("button",{id:"back"},l.a.createElement(b,{onClick:L})))),l.a.createElement("tr",null,l.a.createElement("td",null,"Name:"),l.a.createElement("td",null,l.a.createElement("input",{type:"text",value:this.state.name,size:"10",onChange:this.handleChange}))),l.a.createElement("tr",null,l.a.createElement("td",{colSpan:"2"},l.a.createElement("input",{type:"submit",value:"Create Lobby"}))))))}}]),a}(l.a.Component);function g(e){var t=function(e){var t=e.player;return l.a.createElement("tr",null,l.a.createElement("td",null,t))};return console.log(e),l.a.createElement("table",null,l.a.createElement("tbody",null,e.players.map((function(e,a){return l.a.createElement(t,{player:e,key:a})})),l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("button",{type:"button",className:"form-button",onClick:e.start},"Start"))),l.a.createElement("tr",null,l.a.createElement("td",null,"Code: ",e.code))))}var O,N=a(7),k=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).socket=e.socket,n.localPlayerName=e.localPlayer,n.state={players:e.players,choices:[],message:""},n.onmessage=n.onmessage.bind(Object(i.a)(n)),n.getLocalPlayer=n.getLocalPlayer.bind(Object(i.a)(n)),n.socket.onmessage=n.onmessage,n}return Object(s.a)(a,[{key:"onmessage",value:function(e){var t=e.data;console.log(t);var a=JSON.parse(t);switch(a.type){case"update":this.setState({players:a.content});break;case"info":alert(a.content);break;case"choice":this.setState({choices:a.content,message:a.message});break;case"stopChoice":this.setState({choices:[],message:"Waiting for others..."});break;default:console.warn("Unrecognized type "+a.type)}}},{key:"numInfluence",value:function(e){var t,a=0,n=Object(N.a)(e);try{for(n.s();!(t=n.n()).done;){null!==t.value&&a++}}catch(l){n.e(l)}finally{n.f()}return a}},{key:"getLocalPlayer",value:function(){console.log(this.state.players),console.log(this.localPlayerName);var e,t=Object(N.a)(this.state.players);try{for(t.s();!(e=t.n()).done;){var a=e.value;if(a.name===this.localPlayerName)return a}}catch(n){t.e(n)}finally{t.f()}return{name:"",cards:[],coins:0}}},{key:"onChoice",value:function(e){this.setState({choices:[],message:"Waiting for others..."}),this.socket.send(JSON.stringify(e))}},{key:"render",value:function(){var e=this,t=function(t){var a=t.player,n=t.influence,r=t.coins;return l.a.createElement("div",{className:a===e.localPlayerName?"local-player-icon":"player-icon"},a," ",l.a.createElement("br",null),"Coins: ",r," ",l.a.createElement("br",null),"Influence: ",n)},a=function(t){var a=t.choice;return l.a.createElement("button",{className:"game-button",onClick:function(){return e.onChoice(a)}},l.a.createElement("div",{className:"player-icon"},a))};return l.a.createElement("div",null,l.a.createElement("div",{className:"game-container"},this.state.players.map((function(a){return l.a.createElement(t,{key:a.name,player:a.name,coins:a.coins,influence:e.numInfluence(a.cards)})}))),l.a.createElement("div",{className:"game-container"},this.getLocalPlayer().cards.map((function(e){return null===e?null:l.a.createElement("div",{className:"card-names"},e)}))),l.a.createElement("div",{className:"game-container"},this.state.message),l.a.createElement("div",{className:"game-container"},this.state.choices.map((function(e,t){return l.a.createElement(a,{key:t,choice:e})}))))}}]),a}(l.a.Component),S=new function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(o.a)(this,e),Object.assign(this,t)}({name:"",code:""}),C=!1;function j(e,t,a){var n=new XMLHttpRequest;n.open("POST","/lobby"),n.setRequestHeader("Content-type","application/json"),n.onreadystatechange=function(){4===n.readyState&&200===n.status&&a(JSON.parse(n.responseText))},n.send(JSON.stringify({type:e,code:t}))}function w(){var e=l.a.createElement("div",{className:"App"},l.a.createElement("header",{className:"App-header"},l.a.createElement("h1",null,"Influence"),l.a.createElement(v,{store:S})));c.a.render(e,document.getElementById("root"))}function I(){var e=l.a.createElement("div",{className:"App"},l.a.createElement("header",{className:"App-header"},l.a.createElement("h1",null,"Influence"),l.a.createElement(y,{store:S})));c.a.render(e,document.getElementById("root"))}function A(e){if(console.log(e.data),!C)if("Start"===e.data)C=!0,function(){var e=l.a.createElement("header",{className:"App-header"},l.a.createElement(k,{socket:O,players:[],localPlayer:S.name}));c.a.render(e,document.getElementById("root"))}();else{var t=JSON.parse(e.data),a=l.a.createElement("div",{className:"App"},l.a.createElement("header",{className:"App-header"},l.a.createElement("div",{id:"centered"},l.a.createElement(g,{players:t,code:S.code,start:x}))));c.a.render(a,document.getElementById("root"))}}function P(){var e=window.location,t="https:"===e.protocol?"wss:":"ws:";t+="//"+e.host,t=(t+="/join/"+S.code+"/"+S.name).replace("3000","8080"),console.log(t),(O=new WebSocket(t)).onmessage=A,O.onopen=function(e){console.debug("Opened!")},O.onclose=function(e){console.debug(e),alert("The server disconnected unexpectedly!")};var a=l.a.createElement("div",{className:"App"},l.a.createElement("header",{className:"App-header"},l.a.createElement("div",{id:"centered"},l.a.createElement(g,{players:[],code:S.code,start:x}))));c.a.render(a,document.getElementById("root"))}function x(){console.log("Starting!"),j("start",S.code,(function(){}))}function J(){return l.a.createElement("table",{className:"buttons"},l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("button",{type:"button",className:"form-button",onClick:w},"Create"))),l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("button",{type:"button",className:"form-button",onClick:I},"Join")))))}function L(){var e=l.a.createElement("div",{className:"App"},l.a.createElement("header",{className:"App-header"},l.a.createElement("h1",null,"Influence"),l.a.createElement(J,null)));c.a.render(e,document.getElementById("root"))}var B=function(){return l.a.createElement("div",{className:"App"},l.a.createElement("header",{className:"App-header"},l.a.createElement("h1",null,"Influence"),l.a.createElement(J,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(B,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},9:function(e,t,a){e.exports=a(16)}},[[9,1,2]]]);
//# sourceMappingURL=main.d16f8d23.chunk.js.map